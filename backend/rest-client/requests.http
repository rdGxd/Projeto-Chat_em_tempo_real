# ============================================
# üîß CONFIGURA√á√ïES GLOBAIS
# ============================================

# üîß DESENVOLVIMENTO
@baseUrl = http://localhost:3001

# üîß PRODU√á√ÉO
# @baseUrl = https://api.seuprojeto.com

# üîß STAGING
# @baseUrl = https://staging-api.seuprojeto.com

@emailForTesting = admin@ecommerce.com
@passwordForTesting = admin123
@accessToken = {{loginUser.response.body.accessToken}}
@refreshToken = {{loginUser.response.body.refreshToken}}
@emailForTesting2 = user@ecommerce.com
@passwordForTesting2 = user123
@userId = {{registerUser.response.body.id}}
@roomId = {{createRoom.response.body.id}}

# ============================================
# üéØ SCRIPTS DE CEN√ÅRIOS
# ============================================

# üìù SCRIPT 1: FLUXO COMPLETO DE ADMINISTRADOR
# Sequ√™ncia: Login Admin ‚Üí Criar Sala ‚Üí Criar Mensagem ‚Üí Gerenciar Usu√°rios

# üìù SCRIPT 2: FLUXO COMPLETO DE USU√ÅRIO COMUM
# Sequ√™ncia: Registro ‚Üí Login ‚Üí Entrar em Sala ‚Üí Enviar Mensagem

# ============================================
# üîê AUTENTICA√á√ÉO
# ============================================

### Login de Usu√°rio
# @name loginUser
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "{{emailForTesting}}",
  "password": "{{passwordForTesting}}"
}

### Refresh Token
# @name refreshToken
POST {{baseUrl}}/auth/refresh
Content-Type: application/json

{
  "refreshToken": "{{refreshToken}}"
}

### Registrar Novo Usu√°rio
# @name registerUser
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "name": "Testando",
  "email": "1{{emailForTesting}}",
  "password": "{{passwordForTesting}}"
}

# ============================================
# üéØ SCRIPT 1: FLUXO ADMINISTRADOR
# ============================================

### [SCRIPT 1 - PASSO 1] Login como Admin
# @name script1_loginAdmin
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "{{emailForTesting}}",
  "password": "{{passwordForTesting}}"
}

### [SCRIPT 1 - PASSO 2] Criar Sala como Admin
# @name script1_createRoom
POST {{baseUrl}}/room
Content-Type: application/json
Authorization: Bearer {{script1_loginAdmin.response.body.accessToken}}

{
  "name": "Sala Admin - {{$timestamp}}"
}

### [SCRIPT 1 - PASSO 3] Listar Todas as Salas
# @name script1_getAllRooms
GET {{baseUrl}}/room
Content-Type: application/json
Authorization: Bearer {{script1_loginAdmin.response.body.accessToken}}

### [SCRIPT 1 - PASSO 4] Criar Mensagem na Sala
# @name script1_createMessage
POST {{baseUrl}}/message
Content-Type: application/json
Authorization: Bearer {{script1_loginAdmin.response.body.accessToken}}

{
  "content": "Mensagem do Administrador - {{$timestamp}}",
  "room": "{{script1_createRoom.response.body.id}}"
}

# ============================================
# üéØ SCRIPT 2: FLUXO USU√ÅRIO COMUM
# ============================================

### [SCRIPT 2 - PASSO 1] Registrar Novo Usu√°rio
# @name script2_registerUser
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "name": "Usu√°rio Teste {{$timestamp}}",
  "email": "user{{$timestamp}}@test.com",
  "password": "user123"
}

### [SCRIPT 2 - PASSO 2] Login do Novo Usu√°rio
# @name script2_loginUser
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "user{{$timestamp}}@test.com",
  "password": "user123"
}

### [SCRIPT 2 - PASSO 3] Buscar Salas Dispon√≠veis
# @name script2_findRooms
GET {{baseUrl}}/room
Content-Type: application/json
Authorization: Bearer {{script2_loginUser.response.body.accessToken}}

### [SCRIPT 2 - PASSO 4] Entrar em uma Sala Espec√≠fica
# @name script2_getRoomDetails
GET {{baseUrl}}/room/{{script1_createRoom.response.body.id}}
Content-Type: application/json
Authorization: Bearer {{script2_loginUser.response.body.accessToken}}

### [SCRIPT 2 - PASSO 5] Enviar Mensagem na Sala
# @name script2_sendMessage
POST {{baseUrl}}/message
Content-Type: application/json
Authorization: Bearer {{script2_loginUser.response.body.accessToken}}

{
  "content": "Ol√°! Sou um usu√°rio comum - {{$timestamp}}",
  "room": "{{script1_createRoom.response.body.id}}"
}

# ============================================
# üß™ SCRIPT 3: TESTES DE CARGA/STRESS
# ============================================

### [SCRIPT 3 - PASSO 1] Criar M√∫ltiplos Usu√°rios
# @name script3_createUser1
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "name": "Stress Test User 1",
  "email": "stress1_{{$timestamp}}@test.com",
  "password": "stress123"
}

### [SCRIPT 3 - PASSO 2] Criar Usu√°rio 2
# @name script3_createUser2
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "name": "Stress Test User 2",
  "email": "stress2_{{$timestamp}}@test.com",
  "password": "stress123"
}

### [SCRIPT 3 - PASSO 3] Login Simult√¢neo User 1
# @name script3_loginUser1
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "stress1_{{$timestamp}}@test.com",
  "password": "stress123"
}

### [SCRIPT 3 - PASSO 4] Login Simult√¢neo User 2
# @name script3_loginUser2
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "stress2_{{$timestamp}}@test.com",
  "password": "stress123"
}

### [SCRIPT 3 - PASSO 5] Criar Sala para Stress Test
# @name script3_createStressRoom
POST {{baseUrl}}/room
Content-Type: application/json
Authorization: Bearer {{script3_loginUser1.response.body.accessToken}}

{
  "name": "Stress Test Room {{$timestamp}}"
}

### [SCRIPT 3 - PASSO 6] Envio de Mensagens Sequenciais User 1
# @name script3_message1
POST {{baseUrl}}/message
Content-Type: application/json
Authorization: Bearer {{script3_loginUser1.response.body.accessToken}}

{
  "content": "Mensagem 1 do User 1 - {{$timestamp}}",
  "room": "{{script3_createStressRoom.response.body.id}}"
}

### [SCRIPT 3 - PASSO 7] Envio de Mensagens Sequenciais User 2
# @name script3_message2
POST {{baseUrl}}/message
Content-Type: application/json
Authorization: Bearer {{script3_loginUser2.response.body.accessToken}}

{
  "content": "Mensagem 1 do User 2 - {{$timestamp}}",
  "room": "{{script3_createStressRoom.response.body.id}}"
}

# ============================================
# üîç SCRIPT 4: DEBUGGING E VALIDA√á√ïES
# ============================================

### [SCRIPT 4 - PASSO 1] Teste de Token Inv√°lido
# @name script4_invalidToken
GET {{baseUrl}}/room
Content-Type: application/json
Authorization: Bearer token_invalido_para_teste

### [SCRIPT 4 - PASSO 2] Teste de Cria√ß√£o com Dados Inv√°lidos
# @name script4_invalidRoomData
POST {{baseUrl}}/room
Content-Type: application/json
Authorization: Bearer {{loginUser.response.body.accessToken}}

{
  "name": ""
}

### [SCRIPT 4 - PASSO 3] Teste de Acesso a Recurso Inexistente
# @name script4_nonExistentRoom
GET {{baseUrl}}/room/999999
Content-Type: application/json
Authorization: Bearer {{loginUser.response.body.accessToken}}

### [SCRIPT 4 - PASSO 4] Teste de Login com Credenciais Inv√°lidas
# @name script4_invalidLogin
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "email_inexistente@test.com",
  "password": "senha_errada"
}

# ============================================
# üè† GERENCIAMENTO DE SALAS
# ============================================

### Criar Nova Sala
# @name createRoom
POST {{baseUrl}}/room
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "Sala de Teste"
}

### Listar Todas as Salas
# @name getAllroom
GET {{baseUrl}}/room
Content-Type: application/json
Authorization: Bearer {{accessToken}}

### Obter Sala por ID
# @name getRoomById
GET {{baseUrl}}/room/{{roomId}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

### Atualizar Sala
# @name updateRoom
PUT {{baseUrl}}/room/{{roomId}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "Sala de Teste Atualizada"
}

### Deletar Sala
# @name deleteRoom
DELETE {{baseUrl}}/room/{{roomId}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

# ============================================
# üí¨ GERENCIAMENTO DE MENSAGENS
# ============================================

### Criar Nova Mensagem
# @name createMessage
POST {{baseUrl}}/message
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "content": "Mensagem de Teste",
  "room": "{{roomId}}"
}

### Listar Mensagens de uma Sala
# @name getMessagesByRoom
GET {{baseUrl}}/room/{{roomId}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

### Atualizar Mensagem
# @name updateMessage
PUT {{baseUrl}}/message/messageId
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "content": "Mensagem Atualizada"
}

### Deletar Mensagem
# @name deleteMessage
DELETE {{baseUrl}}/message/messageId
Content-Type: application/json
Authorization: Bearer {{accessToken}}

# ============================================
# üë§ GERENCIAMENTO DE USU√ÅRIOS
# ============================================

### Obter Perfil do Usu√°rio
# @name getUserProfile
GET {{baseUrl}}/user/profile
Content-Type: application/json
Authorization: Bearer {{accessToken}}

### Atualizar Perfil do Usu√°rio
# @name updateUserProfile
PUT {{baseUrl}}/user/{{userId}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "Nome Atualizado"
}

### Atualizar Senha do Usu√°rio
# @name updateUserPassword
PUT {{baseUrl}}/user/{{userId}}/password
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "currentPassword": "{{passwordForTesting}}",
  "newPassword": "novaSenha123"
}
